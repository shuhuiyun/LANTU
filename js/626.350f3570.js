"use strict";(self["webpackChunk_22_project_20240328"]=self["webpackChunk_22_project_20240328"]||[]).push([[626],{7836:function(t,e,a){a.d(e,{A:function(){return f}});var s=a(6768),o=a(4232);const l={class:"modal",ref:"modal",tabindex:"-1",style:{"margin-top":"8%"}},n={class:"modal-dialog modal-sm"},i={class:"modal-content"},d={class:"modal-header"},r={class:"modal-title"},c=(0,s.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),p={class:"modal-body"},u=["textContent"],m={class:"modal-footer"},b=(0,s.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function h(t,e,a,h,k,g){return(0,s.uX)(),(0,s.CE)("div",l,[(0,s.Lk)("div",n,[(0,s.Lk)("div",i,[(0,s.Lk)("div",d,[(0,s.Lk)("h5",r,(0,o.v_)(`刪除${a.title}`),1),c]),(0,s.Lk)("div",p,[(0,s.Lk)("p",null,[(0,s.eW)(" 確定要刪除 "),(0,s.Lk)("span",{class:"fw-bold",textContent:(0,o.v_)(a.product.title||a.product.id)},null,8,u),(0,s.eW)(" "+(0,o.v_)(`這項${a.title}嗎？`),1)])]),(0,s.Lk)("div",m,[b,(0,s.Lk)("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=e=>t.$emit("del-product",a.product))}," 確認 ")])])])],512)}var k=a(8282),g={data(){return{Mtitle:""}},props:["product","title"],mixins:[k.A]},L=a(1241);const v=(0,L.A)(g,[["render",h]]);var f=v},557:function(t,e,a){a.d(e,{A:function(){return g}});var s=a(6768),o=a(4232),l=a(5130);const n={"aria-label":"Page navigation example "},i={class:"pagination justify-content-center"},d=(0,s.Lk)("i",{class:"bi bi-chevron-double-left"},null,-1),r=[d],c=["onClick"],p=(0,s.Lk)("i",{class:"bi bi-chevron-double-right"},null,-1),u=[p];function m(t,e,a,d,p,m){return(0,s.uX)(),(0,s.CE)("nav",n,[(0,s.Lk)("ul",i,[(0,s.Lk)("li",{class:(0,o.C4)(["page-item",{disabled:!a.pages.has_pre}])},[(0,s.Lk)("a",{"aria-label":"prePage",class:"page-link",href:"#",onClick:e[0]||(e[0]=(0,l.D$)((t=>m.prePage(a.pages.current_page)),["prevent"]))},r)],2),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.pages.total_pages,(t=>((0,s.uX)(),(0,s.CE)("li",{class:(0,o.C4)(["page-item",{active:t===a.pages.current_page}]),style:{"border-radius":"5px"},key:t},[(0,s.Lk)("a",{class:"page-link",href:"#",onClick:(0,l.D$)((e=>m.updatePage(t)),["prevent"])},(0,o.v_)(t),9,c)],2)))),128)),(0,s.Lk)("li",{class:(0,o.C4)(["page-item",{disabled:!a.pages.has_next}])},[(0,s.Lk)("a",{"aria-label":"currentPage",class:"page-link",href:"#",onClick:e[1]||(e[1]=(0,l.D$)((t=>m.nextPage(a.pages.current_page)),["prevent"]))},u)],2)])])}var b={props:["pages"],methods:{updatePage(t){this.$emit("emit-page",t)},nextPage(t){this.$emit("emit-page",`${t+1}`)},prePage(t){this.$emit("emit-page",""+(t-1))}}},h=a(1241);const k=(0,h.A)(b,[["render",m]]);var g=k},9626:function(t,e,a){a.r(e),a.d(e,{default:function(){return et}});var s=a(6768),o=a(4232);const l={class:"g-5 products-list__content"},n={class:"row mt-5 border-bottom border-primary pb-4 border-1"},i=(0,s.Lk)("div",{class:"col-6 text-start h3 fw-bold m-0 text-dark"},"折價券",-1),d={class:"col-6 text-end"},r={class:"table mt-2 table-borderless"},c=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",{class:"table-light"},[(0,s.Lk)("th",{width:"120 "},"名稱"),(0,s.Lk)("th",{width:"100"},"折扣百分比"),(0,s.Lk)("th",{width:"120"},"到期日"),(0,s.Lk)("th",{width:"120"},"是否啟用"),(0,s.Lk)("th",{width:"200"},"編輯")])],-1),p={class:"tr-style"},u={class:"py-2"},m={class:"text-right"},b={key:0,class:"text-success"},h={key:1,class:"text-muted"},k={class:"pe-3"},g=["onClick"],L=(0,s.Lk)("i",{class:"bi bi-pen-fill"},null,-1),v=[L],f=["onClick"],C=(0,s.Lk)("i",{class:"bi bi-trash-fill"},null,-1),y=[C];function _(t,e,a,L,C,_){const x=(0,s.g2)("LoadingSpinner"),M=(0,s.g2)("PageNavigation"),O=(0,s.g2)("CunponsModal"),$=(0,s.g2)("DelModal");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(x,{active:C.isLoading},null,8,["active"]),(0,s.Lk)("div",l,[(0,s.Lk)("div",n,[i,(0,s.Lk)("div",d,[(0,s.Lk)("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=t=>_.openModal(!0))}," 新增折價券 ")])]),(0,s.Lk)("table",r,[c,(0,s.Lk)("tbody",p,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(C.coupons,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id},[(0,s.Lk)("td",u,(0,o.v_)(e.title),1),(0,s.Lk)("td",null,(0,o.v_)(e.percent),1),(0,s.Lk)("td",m,(0,o.v_)(t.$filters.date(e.due_date)),1),(0,s.Lk)("td",null,[e.is_enabled?((0,s.uX)(),(0,s.CE)("span",b,"啟用")):((0,s.uX)(),(0,s.CE)("span",h,"未啟用"))]),(0,s.Lk)("td",k,[(0,s.Lk)("button",{type:"button",class:"product__button edit",onClick:t=>_.openModal(!1,e)},v,8,g),(0,s.Lk)("button",{type:"button",class:"product__button del",onClick:t=>_.openDelModal(e)},y,8,f)])])))),128))])]),(0,s.bF)(M,{onEmitPage:_.getProducts,pages:C.pagination},null,8,["onEmitPage","pages"])]),(0,s.bF)(O,{onUpdateOrder:_.updateOrder,coupon:C.tempOrder,ref:"OrderModal"},null,8,["onUpdateOrder","coupon"]),(0,s.bF)($,{product:C.tempOrder,title:C.title,onDelProduct:_.delOrder,ref:"delOrderModal"},null,8,["product","title","onDelProduct"])],64)}var x=a(5130);const M={class:"modal fade",ref:"modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},O={class:"modal-dialog modal-sm"},$={class:"modal-content"},w=(0,s.Lk)("div",{class:"modal-header"},[(0,s.Lk)("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"新增折價券"),(0,s.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),P={class:"modal-body container"},D={class:"row"},E={class:"col-12"},A={class:"input-group mb-3"},X={for:"title",class:"form-label text-start col"},F={class:"input-group mb-3"},U={for:"percent",class:"form-label text-start col"},W={class:"input-group mb-3"},j={for:"due_date",class:"form-label text-start col"},N={class:"input-group mb-3"},V={for:"code",class:"form-label text-start col"},J={class:"mb-3"},S={class:"form-check text-start"},I={class:"form-check-label",for:"is_enabled"},K={class:"modal-footer"},T=(0,s.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function H(t,e,a,o,l,n){return(0,s.uX)(),(0,s.CE)("div",M,[(0,s.Lk)("div",O,[(0,s.Lk)("div",$,[w,(0,s.Lk)("div",P,[(0,s.Lk)("div",D,[(0,s.Lk)("div",E,[(0,s.Lk)("div",A,[(0,s.Lk)("label",X,[(0,s.eW)("標題 "),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>l.tempCoupons.title=t),type:"text",class:"form-control",id:"title",placeholder:"請輸入標題"},null,512),[[x.Jo,l.tempCoupons.title]])])]),(0,s.Lk)("div",F,[(0,s.Lk)("label",U,[(0,s.eW)("折扣 "),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>l.tempCoupons.percent=t),type:"number",class:"form-control",id:"percent",placeholder:"請輸入折扣"},null,512),[[x.Jo,l.tempCoupons.percent]])])]),(0,s.Lk)("div",W,[(0,s.Lk)("label",j,[(0,s.eW)("到期日 "),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>l.due_date=t),type:"date",class:"form-control",id:"due_date"},null,512),[[x.Jo,l.due_date]])])]),(0,s.Lk)("div",N,[(0,s.Lk)("label",V,[(0,s.eW)("內容 "),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>l.tempCoupons.code=t),type:"text",class:"form-control",id:"code",placeholder:"請輸入內容"},null,512),[[x.Jo,l.tempCoupons.code]])])]),(0,s.Lk)("div",J,[(0,s.Lk)("div",S,[(0,s.Lk)("label",I,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>l.tempCoupons.is_enabled=t),class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,id:"is_enabled"},null,512),[[x.lH,l.tempCoupons.is_enabled]]),(0,s.eW)(" 是否啟用 ")])])])])])]),(0,s.Lk)("div",K,[T,(0,s.Lk)("button",{type:"button",class:"btn btn-primary",onClick:e[5]||(e[5]=e=>t.$emit("update-order",l.tempCoupons))}," 上傳 ")])])])],512)}var q=a(8282),z={props:{coupon:{type:Object,default(){return{}}}},watch:{coupon(){this.tempCoupons=this.coupon;const t=new Date(1e3*this.tempCoupons.due_date).toISOString().split("T");[this.due_date]=t},due_date(){this.tempCoupons.due_date=Math.floor(new Date(this.due_date)/1e3)}},data(){return{modal:{},tempCoupons:{},due_date:""}},mixins:[q.A]},B=a(1241);const G=(0,B.A)(z,[["render",H]]);var Q=G,R=a(7836),Y=a(557),Z={data(){return{title:"優惠券",coupons:[],pagination:{},tempOrder:{},isNew:!1,isLoading:!1}},components:{CunponsModal:Q,DelModal:R.A,PageNavigation:Y.A},inject:["emitter","$httpMessageState"],methods:{getProducts(t=1){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/patty-api/admin/coupons/?page=${t}`;this.$http.get(e).then((t=>{this.isLoading=!1,this.coupons=t.data.coupons,this.pagination=t.data.pagination})).catch((()=>{this.emitter.emit("push-message",{style:"danger",title:"取得優惠券失敗",content:"抱歉，出現系統問題，請聯絡我們！"})}))},openModal(t,e){this.tempOrder=t?{due_date:(new Date).getTime()/1e3}:{...e},this.isNew=t;const a=this.$refs.OrderModal;a.showModal()},updateOrder(t){this.tempOrder=t;let e="https://vue3-course-api.hexschool.io/api/patty-api/admin/coupon",a="post";this.isNew||(e=`https://vue3-course-api.hexschool.io/api/patty-api/admin/coupon/${t.id}`,a="put");const s=this.$refs.OrderModal;this.$http[a](e,{data:this.tempOrder}).then((t=>{t.data.success?(this.getProducts(),this.emitter.emit("push-message",{style:"success",title:"更新成功"})):this.emitter.emit("push-message",{style:"danger",title:"更新失敗",content:t.data.message.join("、")}),s.hideModal()})).catch((()=>{this.emitter.emit("push-message",{style:"danger",title:"更新失敗",content:"抱歉，出現系統問題，請聯絡我們！"})}))},openDelModal(t){this.tempOrder={...t};const e=this.$refs.delOrderModal;e.showModal()},delOrder(t){const e=this.$refs.delOrderModal;this.tempOrder=t;const a=`https://vue3-course-api.hexschool.io/api/patty-api/admin/coupon/${t.id}`;this.$http.delete(a,this.tempOrder).then((()=>{e.hideModal(),this.getProducts()})).catch((()=>{this.emitter.emit("push-message",{style:"danger",title:"取得優惠券失敗",content:"抱歉，出現系統問題，請聯絡我們！"})}))}},created(){this.getProducts()}};const tt=(0,B.A)(Z,[["render",_]]);var et=tt}}]);
//# sourceMappingURL=626.350f3570.js.map